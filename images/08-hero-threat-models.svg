<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 630" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
  <!-- Title -->
  <text x="600" y="60" font-family="Arial, sans-serif" font-size="42" font-weight="bold" fill="white" text-anchor="middle">
    Threat Models That Survive Certification
  </text>
  <text x="600" y="95" font-family="Arial, sans-serif" font-size="20" fill="rgba(255,255,255,0.9)" text-anchor="middle">
    Threat → Requirement → Architecture → Test → Safety
  </text>

  <!-- Left: Bad (Generic, no traceability) -->
  <g id="generic">
    <text x="220" y="150" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">
      ❌ Academic Threat Model
    </text>
    <text x="220" y="175" font-family="Arial, sans-serif" font-size="14" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      Theoretical, not traceable
    </text>

    <rect x="70" y="200" width="300" height="330" rx="12" fill="rgba(229, 62, 62, 0.3)" stroke="#E53E3E" stroke-width="3"/>
    
    <!-- Simplified list -->
    <rect x="100" y="220" width="240" height="280" rx="6" fill="rgba(229, 62, 62, 0.5)" stroke="#E53E3E" stroke-width="2"/>
    
    <text x="220" y="250" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">
      89 Threats
    </text>
    
    <text x="220" y="275" font-family="Arial, sans-serif" font-size="13" fill="rgba(255,255,255,0.85)" text-anchor="middle">
      STRIDE dump:
    </text>

    <text x="220" y="310" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • All marked "CRITICAL"
    </text>
    <text x="220" y="335" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • No operational context
    </text>
    <text x="220" y="360" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • No requirement IDs
    </text>
    <text x="220" y="385" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • No architecture link
    </text>
    <text x="220" y="410" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • No test cases
    </text>
    <text x="220" y="435" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      • No safety integration
    </text>

    <!-- Problems -->
    <text x="220" y="475" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      Brainstorming document,
    </text>
    <text x="220" y="492" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      not design artifact
    </text>
    <text x="220" y="517" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FC8181" text-anchor="middle">
      DER: REJECTED
    </text>
  </g>

  <!-- Arrow -->
  <g id="vs-arrow">
    <path d="M 400 360 L 480 360" stroke="white" stroke-width="5" fill="none"/>
    <path d="M 460 353 L 480 360 L 460 367" fill="white"/>
    <text x="440" y="345" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">vs</text>
  </g>

  <!-- Right: Good (Traceable) -->
  <g id="traceable">
    <text x="850" y="150" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">
      ✓ Certifiable Threat Model
    </text>
    <text x="850" y="175" font-family="Arial, sans-serif" font-size="14" fill="rgba(255,255,255,0.8)" text-anchor="middle">
      Scoped, traceable, verifiable
    </text>

    <rect x="510" y="200" width="640" height="330" rx="12" fill="rgba(56, 161, 105, 0.3)" stroke="#38A169" stroke-width="3"/>
    
    <!-- Traceability matrix title -->
    <text x="830" y="225" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white" text-anchor="middle">
      12 Scoped Threats → Full Traceability
    </text>

    <!-- Column headers ABOVE first chain -->
    <text x="595" y="245" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      Threat
    </text>
    <text x="765" y="245" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      Requirement
    </text>
    <text x="940" y="245" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      Architecture
    </text>
    <text x="1095" y="245" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.7)" text-anchor="middle">
      Test
    </text>

    <!-- Example threat chain -->
    <!-- Threat -->
    <rect x="530" y="260" width="130" height="30" rx="5" fill="#E53E3E" stroke="white" stroke-width="1.5"/>
    <text x="595" y="279" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      T1: Rogue Tool
    </text>

    <path d="M 660 275 L 700 275" stroke="white" stroke-width="2"/>
    <path d="M 693 270 L 700 275 L 693 280" fill="white"/>

    <!-- Requirement -->
    <rect x="705" y="260" width="120" height="30" rx="5" fill="#667eea" stroke="white" stroke-width="1.5"/>
    <text x="765" y="279" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      REQ-SEC-01
    </text>

    <path d="M 825 275 L 875 275" stroke="white" stroke-width="2"/>
    <path d="M 868 270 L 875 275 L 868 280" fill="white"/>

    <!-- Architecture -->
    <rect x="880" y="260" width="120" height="30" rx="5" fill="#38A169" stroke="white" stroke-width="1.5"/>
    <text x="940" y="279" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      HMAC + TPM
    </text>

    <path d="M 1000 275 L 1030 275" stroke="white" stroke-width="2"/>
    <path d="M 1023 270 L 1030 275 L 1023 280" fill="white"/>

    <!-- Test -->
    <rect x="1035" y="260" width="120" height="30" rx="5" fill="#4ECDC4" stroke="white" stroke-width="1.5"/>
    <text x="1095" y="279" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      TC-AUTH-14
    </text>

    <!-- Second chain -->
    <rect x="530" y="305" width="130" height="30" rx="5" fill="#E53E3E" stroke="white" stroke-width="1.5"/>
    <text x="595" y="324" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      T2: Replay
    </text>

    <path d="M 660 320 L 700 320" stroke="white" stroke-width="2"/>

    <rect x="705" y="305" width="120" height="30" rx="5" fill="#667eea" stroke="white" stroke-width="1.5"/>
    <text x="765" y="324" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      REQ-SEC-03
    </text>

    <path d="M 825 320 L 875 320" stroke="white" stroke-width="2"/>

    <rect x="880" y="305" width="120" height="30" rx="5" fill="#38A169" stroke="white" stroke-width="1.5"/>
    <text x="940" y="324" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      Counter verify
    </text>

    <path d="M 1000 320 L 1030 320" stroke="white" stroke-width="2"/>

    <rect x="1035" y="305" width="120" height="30" rx="5" fill="#4ECDC4" stroke="white" stroke-width="1.5"/>
    <text x="1095" y="324" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      TC-AUTH-19
    </text>

    <!-- Third chain -->
    <rect x="530" y="350" width="130" height="30" rx="5" fill="#E53E3E" stroke="white" stroke-width="1.5"/>
    <text x="595" y="369" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      T3: Key Extract
    </text>

    <path d="M 660 365 L 700 365" stroke="white" stroke-width="2"/>

    <rect x="705" y="350" width="120" height="30" rx="5" fill="#667eea" stroke="white" stroke-width="1.5"/>
    <text x="765" y="369" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      REQ-SEC-06
    </text>

    <path d="M 825 365 L 875 365" stroke="white" stroke-width="2"/>

    <rect x="880" y="350" width="120" height="30" rx="5" fill="#38A169" stroke="white" stroke-width="1.5"/>
    <text x="940" y="369" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      TPM binding
    </text>

    <path d="M 1000 365 L 1030 365" stroke="white" stroke-width="2"/>

    <rect x="1035" y="350" width="120" height="30" rx="5" fill="#4ECDC4" stroke="white" stroke-width="1.5"/>
    <text x="1095" y="369" font-family="monospace" font-size="9" fill="white" text-anchor="middle">
      TC-CRYP-07
    </text>

    <!-- Ellipsis -->
    <text x="830" y="405" font-family="Arial, sans-serif" font-size="14" fill="rgba(255,255,255,0.5)" text-anchor="middle">
      ... (9 more threats with full traceability)
    </text>

    <!-- Benefits -->
    <text x="830" y="450" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.9)" text-anchor="middle">
      ✓ Operational context
    </text>
    <text x="830" y="470" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.9)" text-anchor="middle">
      ✓ End-to-end traceability
    </text>
    <text x="830" y="490" font-family="Arial, sans-serif" font-size="12" fill="rgba(255,255,255,0.9)" text-anchor="middle">
      ✓ Safety integration
    </text>
    <text x="830" y="517" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#68D391" text-anchor="middle">
      DER: APPROVED
    </text>
  </g>

  <!-- Bottom key insight -->
  <rect x="150" y="555" width="900" height="50" rx="8" fill="rgba(0,0,0,0.4)" stroke="white" stroke-width="2"/>
  <text x="600" y="585" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">
    No traceability. No approval.
  </text>

  <!-- Bottom text -->
  <text x="600" y="625" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-style="italic">
    Article 8 of 8: Security That Survives Certification
  </text>
</svg>
